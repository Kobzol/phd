\documentclass[english,phd]{diploma}

% Packages
% enhanced support for quotation marks, support for biblatex package
\usepackage[autostyle=true]{csquotes}
\usepackage[
    backend=biber,
    giveninits=true, % abbreviate author's first names in bibliography
    style=numeric,
    alldates=iso,
    maxnames=999,    % for my own publications
    maxbibnames=3,   % for bibliography
    defernumbers=true,
    urldate=short,
    sorting=none
]{biblatex}
\usepackage{dcolumn} % numeric column type
%\usepackage{subfig} % subtables and subfigures

\usepackage{subcaption} % subfigure
\captionsetup{compatibility=false}

\newcolumntype{T}{>{\footnotesize}p{6cm}} % Estee table

\usepackage[cpp]{diplomalst}
\usepackage{hyperref}
\usepackage{todonotes}
\usepackage{amsmath}
\usepackage{tikz}
\usetikzlibrary{graphs}
\usetikzlibrary{positioning}
\usetikzlibrary{arrows.meta}
\usetikzlibrary{automata}
\usetikzlibrary{math}
% Source code highlighting
\usepackage[outputdir=../out,newfloat]{minted}
% Multiple footnotes at one place
\usepackage[multiple]{footmisc}
% Autoref with capitalization (need to use Cref)
\usepackage[nameinlink]{cleveref}
% Horizontal margin configuration in description/enumerate/itemize
\usepackage{enumitem}
% SI units (\micro\second, \mebi\byte)
\usepackage[binary-units]{siunitx}

%https://tex.stackexchange.com/questions/70875/how-to-render-individual-acronyms-in-lower-case-when-used-inline-but-mixed-case
% Abbreviations (\gls, \glspl, \acrfull, \acrshort, \acrlong)
\usepackage[
    acronym,        % enable acronyms
    nomain,         % disable main glossary, we only use acronyms
    notranslate     % enable overriding \acronymname without involving babel
]{glossaries}

%\glsdisablehyper    % disable hyperlinks
\input{acronyms}
\renewcommand*{\acronymname}{List of Abbreviations}

\usemintedstyle{vs}
\setminted{tabsize=4}
% [escapeinside=||]
% [tabsize=4]
% [fontsize=\small]

% Fix arrow tips
\tikzset{tips=proper}

% Commands
\newcommand{\comment}[1]{}
\newcommand{\workshare}[1]{\emph{#1}}
\newcommand{\footnoteurl}[1]{\footnote{\url{#1}}}
\newcommand{\Autoref}[1]{\Cref{#1}}

% Tools
\newcommand{\estee}{\textsc{Estee}}
\newcommand{\rsds}{\textsc{RSDS}}
\newcommand{\hyperqueue}{\textsc{HyperQueue}}
\newcommand{\autoalloc}{\emph{autoalloc}}
\newcommand{\Autoalloc}{\emph{Autoalloc}}
\newcommand{\hq}{\textsc{HQ}}
\newcommand{\dask}{\textsc{Dask}}
\newcommand{\ray}{\emph{Ray}}
\newcommand{\snakemake}{\emph{SnakeMake}}
\newcommand{\pycompss}{\emph{PyCOMPSs}}

\graphicspath{{./imgs/}}

% TikZ styles
\tikzset{%
    task/.style={circle, draw},
    data/.style={rectangle, draw, rounded corners},
    arrow/.style={draw, thick, {->}}
}

\renewcommand\lstlistlistingname{List of Source Code Listings}

% 19 pages own publications + references
% 18 pages (compress metadata and remove \newpage)
% 15 pages (abbreviate first names of authors, \small bibliography font)

% Metadata
\ThesisAuthor{Ing. Jakub Beránek}

\ThesisSupervisor{Ing. Jan Martinovič, Ph.D.}

\CzechThesisTitle{Ergonomie a efektivita workflow na HPC klastrech}
\EnglishThesisTitle{Ergonomics and efficiency of workflows on HPC clusters}

\SubmissionYear{2024}

\CzechAbstract{TODO: přeložit}
\CzechKeywords{distribuované výpočty, výpočetní grafy, vysokovýkonnostní počítání}

\EnglishAbstract{This thesis deals with the execution of task graphs on High-performance Computing
(HPC) clusters (supercomputers), with a focus on efficient usage of hardware resources and ergonomic interfaces for
task graph submission. Task graphs are a popular tool for executing scientific workflows on distributed
clusters, but executing them on supercomputers introduces unique challenges, caused mainly by performance
issues caused by the large scale of HPC workflows and also by cumbersome interactions with HPC allocation
managers like PBS (Portable Batch System) or Slurm. This work examines what are the main challenges
in this area and how do they affect task graph execution, and it proposes various approaches for alleviating
these challenges, both in terms of efficiency and developer ergonomics.

This thesis provides three main contributions. Firstly, it provides a task graph simulation environment
that enables prototyping and benchmarking of various task scheduling algorithms, and performs a comprehensive
study of the performance of various task schedulers using this environment. Secondly, it analyzes the
bottlenecks and overall performance of a state-of-the-art task runtime \dask{} and provides an implementation
of an alternative \dask{} server which significantly improves its performance in HPC use-cases. And
primarily, it introduces a meta-scheduling design for effortless execution of task graphs on HPC clusters
that facilitates efficient usage of hardware resources. It also provides a reference implementation
of this design within an HPC-tailored task runtime called \hyperqueue{}, which offers an ergonomic
way of executing task graphs while achieving high hardware utilization on heterogeneous HPC clusters.
\hyperqueue{} is available as open-source software under the MIT (Massachusetts Institute of Technology) license at
\url{https://github.com/it4innovations/hyperqueue}.}
\EnglishKeywords{distributed computing, task graphs, hpc}

\Acknowledgement{I would like to thank my supervisor, Jan Martinovič, for his advice.
I would also like to thank Ada Böhm, Vojtěch Cima and Martin Šurkovský, who have co-authored several
publications with me and supported me during my PhD studies. I am especially grateful to Ada Böhm
for her mentorship and constant readiness to provide both research and technical guidance. My thanks
also go to Vanessa DeRhen for proofreading this thesis.

\vspace{2mm}The development of \estee{} was supported by several projects.
It has received funding from the European High-Performance Computing Joint Undertaking (JU)
under grant agreement No 955648. This work was supported by the Ministry of Education, Youth and Sports of the Czech Republic the e-INFRA CZ (ID: 90140) and ACROSS (ID: MC2104) projects.

The development of \hyperqueue{} was supported by several projects.
It has received funding from the European High-Performance Computing Joint Undertaking (JU) under grant agreement No 956137.
This work was supported by the Ministry of Education, Youth and Sports of the Czech Republic through the e-INFRA CZ (ID: 90254) and LIGATE (ID: MC2102)
projects.

\vspace{2mm}Last but not least, I thank my wife Jana for her support and endless patience.}

\addbibresource{references.bib}
\addbibresource{publications.bib}

\makeglossaries
\begin{document}
\MakeTitlePages

%\glsaddall     % Automatically add all defined acronyms
%\addcontentsline{toc}{chapter}{List of Abbreviations}
\printglossaries

\listoffigures
\clearpage

\listoftables
\clearpage

\lstlistoflistings
%\addcontentsline{toc}{chapter}{List of Source Code Listings}
\clearpage

% Make sure that related publications are first in the bibliography list
\nocite{estee, rsds, hyperqueue, ligate}

\chapter{Introduction}
\label{ch:Introduction}
\input{chapters/introduction}

\chapter{Parallel and distributed computing}
\label{ch:distributed-computing}
\input{chapters/distributed-computing}

\chapter{Task-based programming model}
\label{ch:taskgraphs}
\input{chapters/taskgraphs}

\chapter{Task graph execution on HPC clusters}
\label{ch:sota}
\input{chapters/sota-challenges}

\chapter{Task scheduling analysis}
\label{ch:estee}
\input{chapters/estee}

\chapter{Task runtime optimization}
\label{ch:rsds}
\input{chapters/rsds}

\chapter{Task graph meta-scheduling}
\label{ch:hyperqueue}
\input{chapters/hyperqueue}

\chapter{Conclusion}
\label{ch:conclusion}
\input{chapters/conclusion}

%\chapter*{Závěr}
%\addcontentsline{toc}{chapter}{Závěr}
%\label{ch:conclusion-czech}
%\input{chapters/conclusion-czech}

\chapter*{List of own publication activities}
\label{ch:listofstudentsownpublicationactivities}
\addcontentsline{toc}{chapter}{\nameref{ch:listofstudentsownpublicationactivities}}

\input{chapters/publications-generated}

%\chapter*{List of projects}
%\label{ch:listofprojects}~\addcontentsline{toc}{chapter}{\nameref{ch:listofprojects}}
%\input{chapters/projects}

% Bibliography
\renewcommand*{\bibfont}{\small}
\printbibliography[heading=bibintoc, title={Bibliography}]

\appendix
\input{chapters/appendix}

\end{document}
